# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Типы данных

### interface ICard - Интерфейс карточки товара  
- `id: string` - идентификатор товара в магазине 
- `description: string` - описание товара 
- `image: string` -  адрес картинки товара
- `title: string` - название товара 
- `category: string` - категория товара 
- `price: number | null` - цена товара 
- `selected: boolean` - товар добавлен в корзину или нет

### interface IPage - Интерфейс страницы  
- `counter: number` - счетчик товаров в корзине  
- `catalog: HTMLElement[]` - массив карточек товаров
- `locked: boolean` - блокировка скрола

### interface IModal - Интерфейс модального окна
- `content: HTMLElement` - содержимое модального окна

### interface IBasket - Интерфейс для содержимого корзины 
- `items: HTMLElement[]` - элементы в корзине
- `total: number` - общая сумма
- `list: HTMLElement[]` - выбранные элементы

### interface IOrderForm 
- `payment:string`- способ оплаты  
- `address: string` - адрес доставки

### interface IOrderForm 
- `email: string` - почта покупателя  
- `phone: string` - телефон покупателя 


### interface IOrder extends IAddressForm, IContactsForm -  Интерфейс информация о заказе  
- `total: number` - сумма заказа 
- `items: string[]` - массив идентификаторов купленных товаров

### interface IOrderSuccess - Интерфейс успешной покупки
- `id: string` - айди заказа 
- `total: number` - сумма заказа 


# Базовый код 

## Model

Модель (Model) отвечает за хранение данных приложения и бизнес-логику, связанную с этими данными. Она предоставляет интерфейс для доступа к данным и операциям над ними, однако не знает, как эти данные будут использоваться в других частях приложения.

### Abstract class Model

Назначение: Базовый класс, предназначенный для создания моделей данных, предназначенных для управления данными приложения

Конструктор class Model - Принимает данные для хранения, эвент эмиттер

`constructor(data: Partial<T>, protected events: IEvents) {}`

Методы Model

- `emitChanges` - cообщить всем подписчикам на событие, что модель поменялась

## AppData

Назначение: Класс AppData является представлением глобального состояния приложения.
Наследуется от: Model

Поля класса:

- `catalog: IProductItem[]`: Массив объектов товаров в каталоге.
- `order: IOrder`: Объект с данными, необходимыми для формления заказа.
- `formErrors: FormErrors`: Объект, содержащий ошибки, возникающие при некорректном заполнении формы заказа.

Методы класса:

- `setCatalog`: Метод для установки каталога товаров и отправки соответствующего события об изменении.
- `addToBasket`: Метод для добавления товара в корзину.
- `sumCardsInBasket`: Метод для получение количества товаров в корзине.
- `getTotalBasketPrice`: Метод для вычисления общей стоимости товаров в корзине.
- `deleteFromBasket`: Метод для удаления товара из корзины.
- `clearBasket`: Метод для очистки корзины и заказа.
- `setItems`: Метод для добавления ID товаров в корзине в поле items для order.
- `setOrderField`: Метод для установки значения поля заказа и проверки наличия достаточных данных для оформления заказа.
- `validateOrderForm`: Метод для проверки наличия данных о способе оплаты и адресе доставки.
- `setContactsField`: Метод для установки значения поля контактной информации и проверки наличия достаточных контактных данных для оформления заказа.
- `validateContactsForm`: Метод для проверки наличия данных об электронной почте и номере телефона.
- `resetForm`: Метод для сброса значений формы.
- `resetSelected`: Метод для обновления поля selected во всех товарах после совершения покупки.

### class EventEmitter 

Назначение: Класс EventEmitter представляет собой инструмент для организации обмена данными между компонентами в приложении. Он обеспечивает возможность установки обработчиков событий, вызова событий и их прослушивания.

Конструктор class EventEmitter - включающий события 
 
`constructor() {this._events = new Map<EventName, Set<Subscriber>>();}`
 
Методы class EventEmitter 

- `on`: устанавливает обработчик для события.
- `off`: удаляет обработчик для события.
- `emit`: инициирует событие с переданными данными.


### class Api  

Назначение: Класс содержащий логику отправки запроса на сервер. 

Конструктор class Api -  передает базовый адрес сервера и опциональный обьтект с запросами 
 
`constructor(baseUrl: string, options: RequestInit = {}) {}`
 
Методы class Api 
 
- `get` - получение данных 
- `post` - отправка данных 
- `handleResponse` - обрабатывает ответ с сервера 
 
### class APIWebLarek 

Назначение: взаимодействия с конкретным API-сервером
Наследуется от: Api
Интерфейс: IAPIWebLarek

Поле класса:

- `readonly cdn: string`: URL-адрес контентного сервера.

Методы класса:

- `getCards`: Метод получения списка товаров.
- `getCardsId`: Метод получения информации о конкретном товаре по его идентификатору.
- `getOrder`: Метод оформления заказа на товар.


##  View

### abstract class Component  

Назначение: Абстрактный базовый класс необходим для создания и отрисовки пользовательского интерфейся,а также обеспечивающий инструментарий для работы с DOM-элементами в дочерних компонентах. Является родительским для всех классов слоя отображения (View).

Конструктор class Component принимает родительский элемент
 
`protected constructor(protected readonly container: HTMLElement) {}`

Методы class Component 

- `toggleClass` - Переключатель классов
- `setText` - Устанавливает текстовое содержимое для компонента 
- `setImage` - Устанавливает изоброжение
- `setDisabled` - Меняет статус блокировки
- `setHidden` - Скрывает компонент 
- `setVisible` - Делает видимим компонент
- `render` - возвращает корневой DOM-элемент

### Page:

Назначение: Page управляет отображением содержимого главной страницы приложения, такими как каталог продуктов и счетчик элементов.
Наследуется от: Component
Интерфейс: IPage

Конструктор class Page принимает родительский элемент и обработчик событий

`constructor(container: HTMLElement, protected events: IEvents)`

Поля класса:

- `protected _catalog: HTMLElement`: Элемент каталога товаров.
- `protected _basket: HTMLElement`: Элемент корзины.
- `protected _counter: HTMLElement`: Элемент счетчика товаров в корзине.
- `protected _wrapper: HTMLElement`: Элемент обертки страницы.

Методы класса (сеттеры):

- `set catalog`: Устанавливает список элементов каталога товаров на странице.
- `set counter`: Устанавливает значение счетчика товаров в корзине.
- `set locked`: Устанавливает состояние прокрутки.

### class Card 

Назначение: класс который используется для отрисовки карточек
Наследуется от: Component
Интерфейс: ICard

Поля класса:

- `protected _title: HTMLElement`: Элемент заголовка продукта.
- `protected _image?: HTMLImageElement`: Элемент изображения продукта.
- `protected _description?: HTMLElement`: Элемент описания продукта.
- `protected _category?: HTMLElement`: Элемент для отображения категории продукта.
- `protected _price: HTMLElement`: Элемент для отображения цены продукта.
- `protected _button?: HTMLButtonElement`: Элемент кнопки.

Конструктор class Card родительский контейнер и объект с колбэк функциями

`constructor(protected container: HTMLElement, actions?: ICardActions)`

Методы класса:

- `set id`: Устанавливает идентификатор продукта.
- `set title`: Устанавливает заголовок продукта.
- `set image`: Устанавливает изображение продукта.
- `set category`: Устанавливает категорию продукта.
- `set selected`: Устанавливает условие выбрали товар или нет.
- `set price`: Устанавливает цену продукта.
- `set description`: Устанавливает описания продукта.

### class Modal 

Назначение: класс который отвечает за создание и управление модальными окнами, включая их открытие, закрытие и управление содержимым.
Наследуется от: Component
Интерфейс: IModal

Поля класса:

- `_closeButton: HTMLButtonElement`: Кнопка для закрытия модального окна.
- `_content: HTMLElement`: Элемент контента модального окна.

Конструктор class Page принимает родительский элемент и обработчик событий

`constructor(container: HTMLElement, protected events: IEvents)`

Методы класса:

- `set content`: Устанавливает содержимое модального окна (сеттер).
- `open`: Открывает модальное окно и отправляет соответствующее событие.
- `close`: Закрывает модальное окно, очищает контент и отправляет соответствующее событие.
- `render`: Выполняет рендеринг модального окна с учетом переданных данных.

### class Basket 

Назначение: класс который оторбражает корзину и входящие в него товары, а также предоставляет методы для управления элементами в корзине
Наследуется от: Component
Интерфейс: IBasket

Поля класса:

- `protected _item: HTMLElement`: Элемент списка товаров в корзине.
- `protected _total: HTMLElement`: Элемент для отображения общей стоимости товаров в корзине.
- `protected _button: HTMLElement`: Кнопка для оформления заказа.

Конструктор class Basket принимает родительский элемент и обработчик событий

`constructor(container: HTMLElement, protected events: EventEmitter)`

Методы класса (сеттеры):

- `set selected`: Устанавливает список элементов товаров в корзине и состояние книпки оформления заказа (вкл. или выкл.) в зависимости от наличия товаров.
- `set total`: Устанавливает общую стоимость товаров в корзине.
- `disableButton`: Метод отключающий кнопку "Оформить".
- `refreshIndices`: Метод для обновления индексов таблички при удалении товара из корзины.

### class Form 

Назначение: Класс управляет отображением и взаимодействием с формами, такие установкой значений полей и валидации.
Наследуется от: Component

Поля класса:

- `protected _submit: HTMLButtonElement`: Кнопка отправки формы.
- `protected _errors: HTMLElement`: Элемент для отображения ошибок формы.

Конструктор class Form принимает родительский элемент и обработчик событий

`constructor(container: HTMLFormElement, events: IEvents)`

Методы класса:

- `set valid`: Устанавливает состояние кнопки отправки (активное/неактивное) в зависимости от валидности формы (сеттер).
- `set errors`: Устанавливает значение текста ошибок в форме (сеттер).
- `render`: Выполняет рендеринг компонентов формы с учетом переданного состояния.
- `onInputChange`: Отправляет событие об изменении данных ввода.

### class AddressForm 

Назначение: Класс формы для ввода адреса доставки товара.
Наследуется от: Form
Интерфейс: IOrderSuccess


Поле класса:

- `protected _buttonPayments: HTMLButtonElement[]`: Массив с элементами, отвечающими за выбор способа оплаты.

Метод класса:

- `set address`: Устанавливает значение для поля адреса.


### class ContactsForm 

Назначение: Класс формы для ввода контактных данных клиента.
Наследуется от: Form
Интерфейс: IOrderForm


Методы класса:

- `set phone`: Устанавливает значение для поля телефона.
- `set email`: Устанавливает значение для поля email.


### class success 
- класс который отображает успешный заказ, наследуется от Component

Назначение:  Класс отвечает за отображение интерфейса успешной покупки.
Наследуется от: Component
Интерфейс: IOrderSuccess

Поля класса:

- `protected _close: HTMLElement`: Элемент для кнопки закрытия сообщения.
- `protected _successSum: HTMLElement`: Элемент для отображения суммы списания.

Метод класса:

- `set total`: Устанавливает текст со значением суммы списания.


## Presenter 
В этом проекте Presenter не вынесен в отдельный класс, он реализуется в файле index.ts. 






## Приложение реализовано по MVP архитектуре и состоит из компонентов 

### MVP - Этот паттерн разделяет приложение на три части: model, view и presenter. Модель содержит данные, представление отображает данные, а презентер обрабатывает взаимодействие между моделью и представлением.


`cards:changed` - Инициируется при изменении списка товаров и вызывает перерисовку списка товаров на странице.

`card:select` - Инициируется при клике на карточку товара и приводит к открытию модального окна с подробным описанием товара.

`card:toBasket` Инициируется при клике на кнопку "В корзину" в модальном окне и отправляет товар в корзину.

`basket:open` - Инициируется при клике на кнопку "корзина" и открывает модальное окно с классом Basket, где отображаются товары добавленные в корзину.

`basket:delete` - Инициируется при клике на кнопку удаления товара в корзине и удаляет тавары из корзины.

`order:open` - Инициируется при клике на кнопку "Оформить" в корзине Открывает окно с формой для заполнения адреса и способа оплаты.

`order:submit` - Инициируется при нажатии на кнопку "Далее" на стадии заполнения адреса и способа оплаты в модальном окне.

`buttonPayments:select` - Инициируется при нажатии на кнопку выбора способа оплаты.

`addressFormErrors:change` - Инициируется при вводе данных в форму модального окна и совершает процесс валидации формы, возвращает ошибки формы

`contactsFormErrors:change` - Инициируется при вводе данных в форму модального окна и совершает процесс валидации формы, возвращает ошибки формы

`contacts:submit` - Инициируется при нажатии на кнопку "Оплатить" на стадии заполнения телефона и электронной почты в модальном окне

`order:success` -  Инициируется при успешном ответе сервера при оплате товара. Открывает модальное окно о успешной оплате

`modal:close` -  Инициируется при клике на кнопку закрытия модального окна или при клике на свободное место вокруг модального окна, снимает блокировку страницы и сбрасывает значение форм